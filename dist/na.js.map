{"version":3,"file":"na.js","names":[],"sources":["../src/na/constants.ts","../src/na/server-time.ts"],"sourcesContent":["/**\n * The hour (UTC) when server maintenance/reset occurs.\n * Server day boundaries align with this time.\n */\nexport const serverMaintenanceHour = 10\n","import dayjs from \"dayjs\"\nimport customParseFormat from \"dayjs/plugin/customParseFormat\"\nimport utc from \"dayjs/plugin/utc\"\n\nimport { serverMaintenanceHour } from \"./constants.js\"\n\ndayjs.extend(customParseFormat)\ndayjs.extend(utc)\n\n/**\n * Gets the server start datetime for a given day offset.\n * The server \"day\" starts at serverMaintenanceHour UTC.\n *\n * @param dayOffset - Offset from current server day (0 = current, -1 = previous, 1 = next).\n * @returns The server start datetime.\n *\n * @example\n * // If current time is 2024-01-15 08:00 UTC (before 10:00)\n * getServerStartDateTime(0)  // Returns 2024-01-14 10:00 (current server day)\n * getServerStartDateTime(-1) // Returns 2024-01-13 10:00 (previous server day)\n * getServerStartDateTime(1)  // Returns 2024-01-15 10:00 (next server day)\n */\nconst getServerStartDateTime = (dayOffset: number): dayjs.Dayjs => {\n    const now = dayjs().utc()\n\n    // Start with today's maintenance hour\n    let serverStart = now.hour(serverMaintenanceHour).minute(0).second(0).millisecond(0)\n\n    // If we're before maintenance hour, current server day started yesterday\n    if (now.isBefore(serverStart)) {\n        serverStart = serverStart.subtract(1, \"day\")\n    }\n\n    // Apply the requested offset\n    if (dayOffset !== 0) {\n        serverStart = serverStart.add(dayOffset, \"day\")\n    }\n\n    return serverStart\n}\n\n/**\n * Get current server start (date and time).\n * This is the most recent maintenance time that has passed.\n */\nexport const getCurrentServerStart = (): dayjs.Dayjs => getServerStartDateTime(0)\n\n/**\n * Get previous server start (date and time).\n */\nexport const getPreviousServerStart = (): dayjs.Dayjs => getServerStartDateTime(-1)\n\n/**\n * Get next server start (date and time).\n */\nexport const getNextServerStart = (): dayjs.Dayjs => getServerStartDateTime(1)\n\n/**\n * Current server start datetime formatted as \"YYYY-MM-DD HH:mm\".\n */\nexport const currentServerStartDateTime = getCurrentServerStart().format(\"YYYY-MM-DD HH:mm\")\n\n/**\n * Current server start date formatted as \"YYYY-MM-DD\".\n */\nexport const currentServerStartDate = getCurrentServerStart().format(\"YYYY-MM-DD\")\n\n/**\n * Previous server start date formatted as \"YYYY-MM-DD\".\n */\nexport const previousServerStartDate = getPreviousServerStart().format(\"YYYY-MM-DD\")\n\n/**\n * Current server date year as a string.\n */\nexport const currentServerDateYear = String(getCurrentServerStart().year())\n\n/**\n * Current server date month as a zero-padded string (01-12).\n */\nexport const currentServerDateMonth = String(getCurrentServerStart().month() + 1).padStart(2, \"0\")\n"],"mappings":"mGAIA,MAAa,EAAwB,GCErC,EAAM,OAAO,EAAkB,CAC/B,EAAM,OAAO,EAAI,CAejB,MAAM,EAA0B,GAAmC,CAC/D,IAAM,EAAM,GAAO,CAAC,KAAK,CAGrB,EAAc,EAAI,KAAK,GAAsB,CAAC,OAAO,EAAE,CAAC,OAAO,EAAE,CAAC,YAAY,EAAE,CAYpF,OATI,EAAI,SAAS,EAAY,GACzB,EAAc,EAAY,SAAS,EAAG,MAAM,EAI5C,IAAc,IACd,EAAc,EAAY,IAAI,EAAW,MAAM,EAG5C,GAOE,MAA2C,EAAuB,EAAE,CAKpE,MAA4C,EAAuB,GAAG,CAKtE,MAAwC,EAAuB,EAAE,CAKjE,EAA6B,GAAuB,CAAC,OAAO,mBAAmB,CAK/E,EAAyB,GAAuB,CAAC,OAAO,aAAa,CAKrE,EAA0B,GAAwB,CAAC,OAAO,aAAa,CAKvE,EAAwB,OAAO,GAAuB,CAAC,MAAM,CAAC,CAK9D,EAAyB,OAAO,GAAuB,CAAC,OAAO,CAAG,EAAE,CAAC,SAAS,EAAG,IAAI"}